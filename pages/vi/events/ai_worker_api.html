<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang='vi'>
  <head>
    <base href='' />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type' />
    <meta content='CyLog,The FusionCOMP Project,Crowd4U,Micro Volunteering,micro-volunteering,Volunteering' name='keywords' />
    <meta name='description' />
    <meta content='width=device-width,initial-scale=0.7' name='viewport' />
    <title>Crowd4U</title>
    <link href='../../ar/events/ai_worker_api.html' hreflang='ar' rel='alternate' />
    <link href='../../bn/events/ai_worker_api.html' hreflang='bn' rel='alternate' />
    <link href='../../bg/events/ai_worker_api.html' hreflang='bg' rel='alternate' />
    <link href='../../zh/events/ai_worker_api.html' hreflang='zh' rel='alternate' />
    <link href='../../en/events/ai_worker_api.html' hreflang='en' rel='alternate' />
    <link href='../../fi/events/ai_worker_api.html' hreflang='fi' rel='alternate' />
    <link href='../../fr/events/ai_worker_api.html' hreflang='fr' rel='alternate' />
    <link href='../../de/events/ai_worker_api.html' hreflang='de' rel='alternate' />
    <link href='../../el/events/ai_worker_api.html' hreflang='el' rel='alternate' />
    <link href='../../hi/events/ai_worker_api.html' hreflang='hi' rel='alternate' />
    <link href='../../id/events/ai_worker_api.html' hreflang='id' rel='alternate' />
    <link href='../../it/events/ai_worker_api.html' hreflang='it' rel='alternate' />
    <link href='../../ja/events/ai_worker_api.html' hreflang='ja' rel='alternate' />
    <link href='../../ko/events/ai_worker_api.html' hreflang='ko' rel='alternate' />
    <link href='../../nl/events/ai_worker_api.html' hreflang='nl' rel='alternate' />
    <link href='../../fa/events/ai_worker_api.html' hreflang='fa' rel='alternate' />
    <link href='../../pt/events/ai_worker_api.html' hreflang='pt' rel='alternate' />
    <link href='../../ru/events/ai_worker_api.html' hreflang='ru' rel='alternate' />
    <link href='../../es/events/ai_worker_api.html' hreflang='es' rel='alternate' />
    <link href='../../th/events/ai_worker_api.html' hreflang='th' rel='alternate' />
    <link href='../../tr/events/ai_worker_api.html' hreflang='tr' rel='alternate' />
    <link href='../../events/ai_worker_api.html' hreflang='x-default' rel='alternate' />
    <link href='../../css/crowd4u.css%3Fdate=20141127.css' rel='stylesheet' type='text/css' />
    <link href='../../css/bootstrap-modal.css' rel='stylesheet' type='text/css' />
    <link href='../../css/sp.css' rel='stylesheet' type='text/css' />
    <!-- Le fav and touch icons -->
    <link href='../../img/for_fc_4u.png' rel='apple-touch-icon' />
    <link href='../../img/favicon.ico' rel='shortcut icon' />
    <script src='../../js/jquery.js'></script>
    <script src='../../js/bootstrap-modal.js'></script>
    <script src='../../js/scrollsmooth.js'></script>
    <script src='../../js/scrolltopcontrol.js'></script>
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src='//html5shim.googlecode.com/svn/trunk/html5.js'></script>
    <![endif]-->
    <!-- Le styles -->
    <!-- Analytics ================================================== -->
    <script type='text/javascript'>
      //<![CDATA[
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-29320352-1']);
        _gaq.push(['_trackPageview']);
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      //]]>
    </script>
  </head>
  <body>
    <!-- Navbar ================================================== -->
    <header id='idx_header'>
      <div id='header_cont'>
        <a class='logo' href='../index.html'>
          <img alt='Crowd4U' height='40' src='../../img/c4u_logo.png' />
        </a>
        <nav id='idx_nav'>
          <ul>
            <li>
              <a class='' href='../../about.html'>
                <img alt='About' src='../../img/icon3w.png' />
              </a>
            </li>
            <li>
              <a class='' href='../../projects.html'>
                <img alt='Projects' src='../../img/icon7w.png' />
              </a>
            </li>
            <li>
              <a class='' href='../contributors.html'>
                <img alt='Contributors' src='../../img/icon1w.png' />
              </a>
            </li>
            <li>
              <a class='' href='../../requester.html'>
                <img alt='Login / Sign up' src='../../img/icon5w.png' />
              </a>
            </li>
          </ul>
        </nav>
        <a class='logo' href='https://play.google.com/store/apps/details?id=org.crowd4u.lockscreen' target='_blank'>
          <img alt='Google Play' height='40' src='../../img/google_play1.png' style='margin-left: 15px; margin-top: -5px;' />
          <br />
        </a>
        <div class='clearfix'></div>
      </div>
    </header>
    <div id='lang_bar'>
      <form>
        <p class='je'>
          <select onchange='if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value'>
            <option value=''>-- Language --</option>
            <option value='/ar/events/ai_worker_api'>Arabic</option>
            <option value='/bn/events/ai_worker_api'>Bengali</option>
            <option value='/bg/events/ai_worker_api'>Bulgarian</option>
            <option value='/zh/events/ai_worker_api'>Chinese</option>
            <option value='/en/events/ai_worker_api'>English</option>
            <option value='/fi/events/ai_worker_api'>Finnish</option>
            <option value='/fr/events/ai_worker_api'>French</option>
            <option value='/de/events/ai_worker_api'>German</option>
            <option value='/el/events/ai_worker_api'>Greek</option>
            <option value='/hi/events/ai_worker_api'>Hindi</option>
            <option value='/id/events/ai_worker_api'>Indonesian</option>
            <option value='/it/events/ai_worker_api'>Italian</option>
            <option value='/ja/events/ai_worker_api'>Japanese</option>
            <option value='/ko/events/ai_worker_api'>Korean</option>
            <option value='/nl/events/ai_worker_api'>Nederlands</option>
            <option value='/fa/events/ai_worker_api'>Persian</option>
            <option value='/pt/events/ai_worker_api'>Portuguese</option>
            <option value='/ru/events/ai_worker_api'>Russian</option>
            <option value='/es/events/ai_worker_api'>Spanish</option>
            <option value='/th/events/ai_worker_api'>Thai</option>
            <option value='/tr/events/ai_worker_api'>Trukish</option>
            <option selected='selected' value='/vi/events/ai_worker_api'>Vietnamese</option>
          </select>
        </p>
      </form>
    </div>
    <div id='lang_bar_comment'>
      <br />
      <p class='je'>
        *
      </p>
    </div>
    <div id='wrapper' style='width: 900px; margin-bottom: 50px;'>
      <!-- Yield ================================================== -->
      <script src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js'></script>
                                                          <style type='text/css'>
                                                            /*<![CDATA[*/
                                                              li.L0, li.L1, li.L2, li.L3,
                                                              li.L5, li.L6, li.L7, li.L8 {
                                                                list-style-type: decimal !important;
                                                              }
                                                            /*]]>*/
                                                          </style>
                                                          <h1>AIワーカ実装のためのAPIの説明</h1>
                                                          <h2>1. AIワーカの動作概要</h2>
                                                          <ol style='padding-left:20px'>
                                                            <li>
                                                              AIワーカは，AIワーカ開発者が用意するCrowd4U外の任意のPC上で動作し，Crowd4Uが提供するタスクの作業を行ない，結果を登録します．
                                                            </li>
                                                            <li>
                                                              AIワーカを実装するには，こちらで用意するPythonライブラリをダウンロードし，サンプルを書き換える方法と，APIを直接利用して自分で開発する方法がありますが，前者をおすすめします．
                                                            </li>
                                                            <li>
                                                              こちらで用意するPythonライブラリには，各APIを呼び出すためのラッパーが関数として用意されています．
                                                            </li>
                                                            <li>
                                                              AIワーカが呼び出すAPI (Pythonライブラリのラッパー関数も同様)は，次の3つのグループに分かれます．
                                                              <ul style='padding-left:20px; list-style-type: circle;'>
                                                                <li>
                                                                  初期化：AIワーカがタスクを行なうクラウドソーシングプロジェクトとの通信の準備をします．
                                                                </li>
                                                                <li>
                                                                  AIワーカを開発・AIワーカが学習するための情報入手： タスク一覧やこれまでのタスク結果を入手したり，特定のタスクの結果を求めることができます．
                                                                </li>
                                                                <li>
                                                                  実際にタスクを行なう：Crowd4Uからタスクを入手し，AIワーカがアルゴリズムで求めたそのタスクの結果をCrowd4Uに送信します．
                                                                </li>
                                                              </ul>
                                                            </li>
                                                            <li>
                                                              Pythonコードのテンプレートの利用方法を
                                                              <a href='ai_worker_api.html#wrapper2'>2節で説明します</a>
                                                              ．Native APIの利用方法は今後掲載します．
                                                            </li>
                                                            <li>
                                                              このドキュメントの内容は今後変更される可能性があります．その場合は，本ページに記載すると共に，登録されたAIワーカのメールアドレスに連絡します．
                                                            </li>
                                                          </ol>
                                                          <!--
                                                            <h2>2. Pythonライブラリによる AIワーカの開発 (Version 20170912β)</h2>
                                                            <a name="wrapper2"></a>
                                                            AIワーカは，WorkerBaseインターフェースをオーバーライドすることで簡単に実装することができます．
                                                            オーバーライドするメソッドはtrainメソッド，outputメソッドの２つです．
                                                            <h3>シンプルなAIワーカの開発</h3>
                                                            <p>
                                                            ここでは，シンプルなAIワーカの開発例を紹介します．
                                                            シンプルなAIワーカは，受け取った2つの書誌情報の本のタイトルが同じなら，同じ書誌とみなし，
                                                            そうでないなら違う書誌とみなします．
                                                            以下がシンプルなAIワーカの実装になります．
                                                            </p>
                                                            <pre class="prettyprint linenums"><code class="">
                                                            # -*- coding: utf-8 -*-
                                                            from workers.worker_base import WorkerBase
                                                            class AlgorithmWorker(WorkerBase):
                                                            def train(self, book1, book2, result):
                                                            pass
                                                            def output(self, book1, book2):
                                                            answer = False
                                                            if book1["title"] == book2["title"]:
                                                            answer = True
                                                            return answer
                                                            </code></pre>
                                                            <h3>trainメソッド</h3>
                                                            <ul>
                                                            <li>目的：trainメソッドに渡される書誌情報から学習モデルを作成します．※シンプルなAIワーカでは利用してません
                                                            <li>引数：書誌情報オブジェクト1, 書誌情報オブジェクト2, 結果情報オブジェクト
                                                            <li>返り値：なし
                                                            </ul>
                                                            <p>
                                                            書誌情報オブジェクトは辞書型で，以下の形で渡されます．
                                                            </p>
                                                            <pre class="prettyprint linenums"><code class="">
                                                            {
                                                            "bib_id": "",
                                                            "title": "",
                                                            "volume": "",
                                                            "responsibility": "",
                                                            "publisher_name": "",
                                                            "issued": "",
                                                            "isbn": "",
                                                            "origin_name": "",
                                                            "origin_id": "",
                                                            "origin_url": "",
                                                            }
                                                            </code></pre>
                                                            <p>
                                                            結果情報は実際にクラウドソーシングに参加したワーカが答えた解答データです．
                                                            結果情報オブジェクトは辞書型です．is_same, is_skipped　それぞれBool値が入ります．
                                                            </p>
                                                            <ul>
                                                            <li> is_same: Trueなら2つの書誌は同じとユーザが答えたことを意味します
                                                            <li> is_skipped: Trueならユーザは書誌が同じかどうかわからなかったということを意味します
                                                            <li> なお，is_same，is_skippedの両方がNoneであるとき，2つの書誌は異なることを意味します．
                                                            </ul>
                                                            <p>例えば以下のような値が入っています．以下の場合は2つの書誌が同じである，とユーザが解答したことを意味します．
                                                            <pre class="prettyprint linenums"><code class="">
                                                            {
                                                            "is_same": True,
                                                            "is_skipped": None
                                                            }
                                                            </code></pre>
                                                            <h3>outputメソッド</h3>
                                                            <ul>
                                                            <li>目的：渡される2つの書誌情報が，同じものか否かBoolで解答します
                                                            <li>引数：書誌情報オブジェクト1, 書誌情報オブジェクト2
                                                            <li>返り値：Bool
                                                            </ul>
                                                          -->
                                                          <div id='wrapper2'></div>
                                                          <h2>2. Pythonライブラリ(APIラッパー関数)による AIワーカの開発 (Version 20170912β)</h2>
                                                          <p>PythonライブラリのAPIラッパー関数について説明します</p>
                                                          <h3 style='font-size:110%'>実行環境とPythonライブラリの入手方法</h3>
                                                          <ul style='padding-left:20px; list-style-type: disc;'>
                                                            <li>
                                                              開発者のPCに最新のPython実行環境が必要です．
                                                            </li>
                                                            <li>
                                                              コードはgithubから入手してください．最新の情報もそちらにありますので，参照してください．
                                                              <p>
                                                                <a href='https://github.com/crowd4u/crowd4py'>https://github.com/crowd4u/crowd4py</a>
                                                              </p>
                                                            </li>
                                                          </ul>
                                                          <h3 style='font-size:110%'>グループ1: 初期化 - AIワーカがクラウドソーシングプロジェクトと通信する準備を行なう</h3>
                                                          <b style='font-weight:bolder'>API: AIワーカとクラウドソーシングプロジェクトの間を接続する</b>
                                                          <p>crowd4pyクラスのクラスメソッドです</p>
                                                          <p>crowd4py.API(プロジェクト名，結果を格納するリレーション名)</p>
                                                          <ul style='padding-left:20px; list-style-type: disc;'>
                                                            <li>
                                                              どのクラウドソーシングプロジェクトのどのタスクを行うのかを設定します．最初に一度だけ呼び出します．
                                                            </li>
                                                            <li>
                                                              引数：プロジェクト名，結果を格納するリレーション名（これらは，AIワーカの申請の許可の連絡と同時に，お教えします．）
                                                            </li>
                                                            <li>
                                                              返り値：apiオブジェクト
                                                            </li>
                                                          </ul>
                                                          <p>作成したapiオブジェクトをハンドラーとして，タスクを取得，送信を行う</p>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code>from __init__ import API_CONF, PROJECT_CONF&#x000A;import crowd4py&#x000A;api = crowd4py.API(api_info=API_CONF, project_info=PROJECT_CONF)</code></pre>
                                                          <p>
                                                            API_CONF,とPROJECT_CONFは，以下の __init__.pyと同じディレクトリ配下にconfig.iniを追加することで自動的に生成され読み込まれます
                                                          </p>
                                                          <p>
                                                            config.iniの内約はAIワーカーとうして登録した時に此方からお送りします．
                                                          </p>
                                                          <p style='padding-top:5px'>__init__.py</p>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code># -*- coding: utf-8 -*-&#x000A;import configparser&#x000A;import os&#x000A;&#x000A;cfg_file = os.path.join(os.path.dirname(__file__), 'config.ini')&#x000A;config = configparser.ConfigParser()&#x000A;config.read(cfg_file)&#x000A;API_CONF = config['crowd4u']&#x000A;PROJECT_CONF = config['project']</code></pre>
                                                          <p style='padding-top:5px'>config.ini</p>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code># -*- coding: utf-8 -*-&#x000A;&#x000A;[crowd4u]&#x000A;API_ROOT = https://crowd4u.org/&#x000A;REQUESTER = 000&#x000A;GROUP_ID  = 00&#x000A;USER_TOKEN = 00000000000000000000&#x000A;[project]&#x000A;ID = 000&#x000A;PROJECT_NAME = project_name&#x000A;RELATION_NAME = relation_name&#x000A;</code></pre>
                                                          <h3 style='font-size:110%'>グループ2: AIワーカを開発・AIワーカが学習するのためのデータを取得する</h3>
                                                          <b style='font-weight:bolder'>get_relation_data: 呼ばれた時点までに行われたタスクとその結果を返す</b>
                                                          <ul style='padding-left:20px; list-style-type: disc;'>
                                                            <li>
                                                              目的：AIワーカを作成するための教師データを得る
                                                            </li>
                                                            <li>
                                                              引数：プロジェクト名（optional), リレーション名（optional）
                                                            </li>
                                                            <li>
                                                              返り値：タスクとその結果が格納されたjson
                                                            </li>
                                                          </ul>
                                                          <p>Classメソッドから呼び出す場合は引数を指定する必要がある</p>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code>>>> import crowd4py&#x000A;>>> crowd4py.API.get_relation_data(project_name="competetion_phase1", relation_name="Results")&#x000A;{"tid":"1354.1356","task_instance_id":1,"group_id":182,"master_bib_id":"Kyoto_Pref_Kpla-100769607",&#x000A;"title_1":"建設部門延長産業連関表","volume_1":"","responsibility_1":"","publisher_name_1":"経済調査会",&#x000A;"issued_1":"1992.0","isbn_1":"","origin_name_1":"京都学・歴彩館","origin_id_1":"100769607",&#x000A;"origin_url_1":"http://opacs.pref.kyoto.lg.jp/mylimedio/search/book.do?bibid=540085",&#x000A;"sub_bib_id":"NDL-R100000002-I000002131701-00","title_2":"東京都産業連関表","volume_2":"昭和60年 計数編",&#x000A;"responsibility_2":"","publisher_name_2":"東京都総務局統計部統計調査課","issued_2":"1991.0","isbn_2":"",&#x000A;"origin_name_2":"全国書誌","origin_id_2":"91066336","origin_url_2":"http://iss.ndl.go.jp/books/R100000002-I000002131701-00",&#x000A;"player_id":"934","is_same":null,"is_skipped":null,"_fact_id":25578}</code></pre>
                                                          <p>コネクションを作った場合は，作成時に渡した情報を参照するので引数は必要ない</p>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code>import crowd4py&#x000A;from __init__ import API_CONF, PROJECT_CONF&#x000A;&#x000A;api = crowd4py.API(api_info=API_CONF, project_info=PROJECT_CONF)&#x000A;json = api.get_relation_data()</code></pre>
                                                          <b style='font-weight:bolder'>request_answer: 指定したタスクの優先順位を上げる</b>
                                                          <ul style='padding-left:20px; list-style-type: disc;'>
                                                            <li>
                                                              目的：AIワーカを作る時，特に情報が欲しいタスクが優先的に行われるようリクエストできます．
                                                            </li>
                                                            <li>
                                                              引数：優先順位を上げたいタスクのタスクID
                                                            </li>
                                                            <li>
                                                              返り値：なし
                                                            </li>
                                                          </ul>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code>import crowd4py&#x000A;from __init__ import API_CONF, PROJECT_CONF&#x000A;&#x000A;api = crowd4py.API(api_info=API_CONF, project_info=PROJECT_CONF)&#x000A;api.request_answer(tid="123.456")</code></pre>
                                                          <h3 style='font-size:110%'>グループ3: Crowd4Uよりタスクを入手し，タスク結果をCrowd4Uに送信する</h3>
                                                          <b style='font-weight:bolder'>get_task: タスクを要求する</b>
                                                          <ul style='padding-left:20px; list-style-type: disc;'>
                                                            <li>
                                                              目的：AIワーカが作業を行うために，タスクを要求します
                                                            </li>
                                                            <li>
                                                              引数：なし
                                                            </li>
                                                            <li>
                                                              返り値：タスクオブジェクト
                                                            </li>
                                                          </ul>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code>import crowd4py&#x000A;from __init__ import API_CONF, PROJECT_CONF&#x000A;&#x000A;api = crowd4py.API(api_info=API_CONF, project_info=PROJECT_CONF)&#x000A;task = api.get_task()</code></pre>
                                                          <p>タスクオブジェクトはタスクの情報が辞書型にまとまったものと，タスクを送信する先のurlの文字列をプロパティとして持ちます．</p>
                                                          <b style='font-weight:bolder'>post_answer: タスクの結果をCrowd4Uに渡す</b>
                                                          <ul style='padding-left:20px; list-style-type: disc;'>
                                                            <li>
                                                              目的：AIワーカがタスクを行った結果を，Crowd4Uに渡します
                                                            </li>
                                                            <li>
                                                              引数：宛先url，dict型の回答
                                                            </li>
                                                            <li>
                                                              返り値：なし
                                                            </li>
                                                          </ul>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code>import crowd4py&#x000A;from __init__ import API_CONF, PROJECT_CONF&#x000A;&#x000A;api = crowd4py.API(api_info=API_CONF, project_info=PROJECT_CONF)&#x000A;task = api.get_task()&#x000A;answer_data = task.data.copy() # 辞書型のオブジェクトをコピー&#x000A;answer_data['is_same'] = True # この例では，is_sameにBool値を入れて解答を行うタイプのタスク&#x000A;task.data = answer_data&#x000A;api.post_answer(post_url=task.get_post_url, ans_data=task.data)</code></pre>
                                                          <h3 style='font-size:110%'>サンプルコード</h3>
                                                          <p>受け取った書籍のタイトルが同じ場合に，同じ書籍とみなす簡単なサンプルになります．</p>
                                                          <pre class='prettyprint linenums' style='margin:10px; padding-left:40px'><code># -*- coding: utf-8 -*-&#x000A;from __init__ import API_CONF, PROJECT_CONF&#x000A;import crowd4py&#x000A;&#x000A;&#x000A;def example_predict(data):&#x000A;    # 書誌のタイトルが同じなら同じ書誌とみなす&#x000A;    print("------Received task bellow-------")&#x000A;    print(data)&#x000A;    if data['title_1'] == data['title_2']:&#x000A;        data['is_same'] = True&#x000A;    else:&#x000A;        data['is_same'] = False&#x000A;    return data&#x000A;&#x000A;if __name__ == '__main__':&#x000A;    api = crowd4py.API(api_info=API_CONF, project_info=PROJECT_CONF)&#x000A;&#x000A;    # 5回タスクに回答&#x000A;    print("------begin to answer-------")&#x000A;    for i in range(5):&#x000A;        task = api.get_task(debug=True)&#x000A;        ans_data = example_predict(task.data)&#x000A;        api.post_answer(task.post_url, ans_data)</code></pre>
      <!-- Yield End -->
    </div>
    <!-- Footer ================================================== -->
    <footer>
      <p class='footer'>
        We need your feedback, bug reports, and any comments.
        <br />
        Contact us using crowd4u#crowd4u.com (replace # with @)
        or
        <a href='http://twitter.com/crowd4u' target='_blank'>@crowd4u</a>.
      </p>
    </footer>
    <!-- Le javascript ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
  </body>
</html>
